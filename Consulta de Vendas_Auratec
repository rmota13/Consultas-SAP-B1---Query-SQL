SELECT 
    CASE 
        WHEN T2.IsIns = 'Y' THEN 'NF Entrega Futura' 
        ELSE 'NF Saída' 
    END AS 'Documento',
    T2.DocNum AS 'Nº_SAP', 
    T2.Serial AS 'Nº_NF',
    T2.CardCode AS 'Cód._PN', 
    T2.CardName AS 'Nome_PN', 
    T2.DocDate AS 'Data_Documento',
    T2.DocDueDate AS 'Data_Vencimento',
    T3.SlpName AS 'Vendedor', 
    T4.PymntGroup AS 'Condição_Pagamento',
    CAST((SELECT SUM(T1.LineTotal) FROM INV1 T1 WHERE T1.DocEntry = T2.DocEntry) AS DECIMAL(19,2)) AS 'Total da linha',
    CAST(T2.TotalExpns AS DECIMAL(19,2)) AS 'Despesas Adicionais', 
    CAST(T2.DiscSum AS DECIMAL(19,2)) AS 'Descontos',
    CAST(T2.DpmAmnt AS DECIMAL(19,2)) AS 'Adiantamento_Total',
    CAST((T2.DocTotal - T2.VatSum + T2.DpmAmnt) AS DECIMAL(19,2)) AS 'Total_Calculado_Final'
FROM OINV T2
INNER JOIN OSLP T3 ON T2.SlpCode = T3.SlpCode
LEFT JOIN OCTG T4 ON T2.GroupNum = T4.GroupNum
WHERE T2.CANCELED <> 'Y'
ORDER BY T2.DocDate DESC, T2.DocNum DESC
