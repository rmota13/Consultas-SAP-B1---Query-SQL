Select T2.DocNum [Doc No.], T2.Cardcode [CardCode], T3.SlpName as 'Vendedor', T2.DocDate,
(Select sum(T1.LineTotal) from RDR1 T1
INNER JOIN ORDR T0 ON
T0.Docentry = T1.Docentry
Where T1.Docentry = T2.Docentry 
Group By T1.Docentry)[Total da linha],
T2.TotalExpns [Despesas Adicionais], T2.DiscSum [Descontos],
T2.DocTotal-T2.Vatsum [Total do documento ap√≥s desconto]
From ORDR T2
INNER JOIN OSLP T3 ON T2.SlpCode = T3.SlpCode
Where T2.CANCELED <> 'y'
