SELECT
   
    T0.ItemCode      AS Codigo_Produto,
    T0.ItemName      AS Nome_Produto,   

    T1.ItmsGrpNam    AS Grupo_Produto,
    T2.FirmName      AS Fabricante,    

    CASE T0.MatType
        WHEN 0 THEN 'Produto Acabado'
        WHEN 1 THEN 'Matéria-Prima'
        WHEN 2 THEN 'Embalagem'
        WHEN 3 THEN 'Serviço'
        ELSE 'Outros'
    END AS Tipo_Material,

    CASE 
        WHEN T0.ProductSrc = 0 THEN 'Nacional'
        WHEN T0.ProductSrc = 1 THEN 'Importação Direta'
        WHEN T0.ProductSrc = 2 THEN 'Estrangeira / Nacional'
        ELSE 'Não informado'
    END AS Origem_Produto,

    T0.NCMCode AS NCM,

    CASE 
        WHEN T0.validFor = 'Y' THEN 'Ativo'
        ELSE 'Inativo'
    END AS Status,

    T0.InvntryUom AS Unidade,
      
    CAST(T0.SWeight1 AS DECIMAL(18,4))          AS Peso_KG,
   
    CASE 
        WHEN T0.SWeight1 IS NULL OR T0.SWeight1 = 0 THEN 'Sem Peso'
        ELSE 'Com Peso'
    END AS Flag_Peso,

    CASE 
        WHEN T0.NCMCode IS NULL OR T0.NCMCode = '' THEN 'Sem NCM'
        ELSE 'Com NCM'
    END AS Flag_NCM,

    T0.CreateDate AS Data_Criacao,
    T0.UpdateDate AS Data_Atualizacao

FROM OITM T0
LEFT JOIN OITB T1 ON T0.ItmsGrpCod = T1.ItmsGrpCod
LEFT JOIN OMRC T2 ON T0.FirmCode  = T2.FirmCode;
